<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Quest Lular ğŸ¼ğŸ§©</title>
<style>
/* Estilos CSS */
body {
    font-family: Arial, sans-serif;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    padding: 0;
    transition: background-color 0.4s ease; /* TransiciÃ³n para el fondo de celebraciÃ³n/error */
}
h1 { text-align: center; color: #000000; margin-top: 20px; }
.menu, .game, .scoreboard { display: none; margin-top: 20px; text-align: center; }
.menu-btn {
    display: inline-block;
    margin: 5px;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 10px;
    border: none;
    background-color: #0b009f;
    color: #fff;
    transition: 0.3s;
}
.menu-btn:hover { background-color: #00bfff; }
.word-btn {
    display: inline-block;
    margin: 10px;
    padding: 15px 25px;
    font-size: 20px;
    cursor: pointer;
    border-radius: 10px;
    border: none;
    background-color: #ffa07a;
    color: #fff;
    transition: 0.2s;
}
.word-btn:hover { background-color: #ff4500; }
#lives, #timer, #score, #highscore { font-size: 20px; margin: 10px; }
/* Clases para efectos visuales */
.correct { background-color: #32cd32 !important; color: #fff; } /* Verde para correcto */
.incorrect { background-color: #ff0000 !important; color: #fff; } /* Rojo para incorrecto */
.scoreboard h2 { color: #0b009f; }
.scoreboard p { font-size: 18px; line-height: 1.5; }
</style>
</head>
<body>

<h1>English Quest Lular ğŸ¼ğŸ§©</h1>

<div class="menu" id="menu">
    <h3>Elige una categorÃ­a</h3>
    <button class="menu-btn" onclick="selectCategory('animals')">ğŸ¶ Animales</button>
    <button class="menu-btn" onclick="selectCategory('colors')">ğŸ¨ Colores</button>
    <button class="menu-btn" onclick="selectCategory('food')">ğŸ Alimentos</button>
    <button class="menu-btn" onclick="selectCategory('objects')">ğŸ  Objetos</button>
    <button class="menu-btn" onclick="selectCategory('clothes')">ğŸ‘• Ropa</button>
    <button class="menu-btn" onclick="selectCategory('vehicles')">ğŸš— VehÃ­culos</button>
    <button class="menu-btn" onclick="selectCategory('emotions')">ğŸ˜Š Emociones</button>
    <button class="menu-btn" onclick="selectCategory('sports')">âš½ Deportes</button>
    <button class="menu-btn" onclick="selectCategory('actions')">âœï¸ Acciones</button>

    <h3>Elige dificultad</h3>
    <button class="menu-btn" onclick="selectDifficulty('easy')">FÃ¡cil (60s)</button>
    <button class="menu-btn" onclick="selectDifficulty('medium')">Medio (45s)</button>
    <button class="menu-btn" onclick="selectDifficulty('hard')">DifÃ­cil (30s)</button>

    <br><br>
    <button class="menu-btn" onclick="startGame()">Iniciar Juego</button>
</div>

<div class="game" id="game">
    <div id="lives">Vidas: â¤ï¸â¤ï¸â¤ï¸</div>
    <div id="timer">Tiempo: 60</div>
    <div id="score">Puntos: 0</div>
    <div id="highscore">Puntaje mÃ¡s alto: 0</div>
    <h2 id="question"></h2>
    <div id="options"></div>
</div>

<div class="scoreboard" id="scoreboard">
    <h2>Â¡Juego terminado! ğŸ†</h2>
    <p id="final-score"></p>
    <p id="final-highscore"></p>
    <p id="final-message"></p>
    <button class="menu-btn" onclick="restartGame()">Volver al menÃº</button>
</div>

<script>
// ====================================================================
// ğŸŒ DICCIONARIO DE PALABRAS (WORDS Object)
// ====================================================================

const WORDS = {
    animals: [
        { es: "Perro", en: ["Dog","Cat","Horse"], a:"Dog", emoji:"ğŸ¶" },
        { es: "Gato", en: ["Cat","Cow","Chicken"], a:"Cat", emoji:"ğŸ±" },
        { es: "Caballo", en: ["Horse","Bear","Duck"], a:"Horse", emoji:"ğŸ´" },
        { es: "Vaca", en: ["Cow","Sheep","Pig"], a:"Cow", emoji:"ğŸ®" },
        { es: "Cerdo", en: ["Pig","Goat","Dog"], a:"Pig", emoji:"ğŸ·" },
        { es: "Oveja", en: ["Sheep","Cat","Rabbit"], a:"Sheep", emoji:"ğŸ‘" },
        { es: "Conejo", en: ["Rabbit","Cat","Dog"], a:"Rabbit", emoji:"ğŸ°" },
        { es: "Mono", en: ["Monkey","Elephant","Lion"], a:"Monkey", emoji:"ğŸ’" },
        { es: "LeÃ³n", en: ["Lion","Tiger","Bear"], a:"Lion", emoji:"ğŸ¦" },
        { es: "Tigre", en: ["Tiger","Lion","Cat"], a:"Tiger", emoji:"ğŸ¯" },
        { es: "Elefante", en: ["Elephant","Rhino","Hippo"], a:"Elephant", emoji:"ğŸ˜" },
        { es: "Zorro", en: ["Fox","Wolf","Bear"], a:"Fox", emoji:"ğŸ¦Š" },
        { es: "Pato", en: ["Duck","Goose","Bird"], a:"Duck", emoji:"ğŸ¦†" },
        { es: "RatÃ³n", en: ["Mouse","Rat","Hamster"], a:"Mouse", emoji:"ğŸ­" },
        { es: "Serpiente", en: ["Snake","Lizard","Worm"], a:"Snake", emoji:"ğŸ" },
        { es: "Pez", en: ["Fish","Shark","Whale"], a:"Fish", emoji:"ğŸ " },
        { es: "Jirafa", en: ["Giraffe","Zebra","Deer"], a:"Giraffe", emoji:"ğŸ¦’" },
        { es: "Oso", en: ["Bear","Wolf","Fox"], a:"Bear", emoji:"ğŸ»" },
        { es: "PÃ¡jaro", en: ["Bird","Eagle","Hawk"], a:"Bird", emoji:"ğŸ¦" },
        { es: "Cebra", en: ["Zebra","Donkey","Giraffe"], a:"Zebra", emoji:"ğŸ¦“" }
    ],
    colors: [
        { es: "Rojo", en: ["Red","Blue","Green"], a:"Red", emoji:"ğŸŸ¥" },
        { es: "Azul", en: ["Blue","Yellow","Green"], a:"Blue", emoji:"ğŸŸ¦" },
        { es: "Verde", en: ["Green","Red","Blue"], a:"Green", emoji:"ğŸŸ©" },
        { es: "Amarillo", en: ["Yellow","Red","Green"], a:"Yellow", emoji:"ğŸŸ¨" },
        { es: "Naranja", en: ["Orange","Purple","Blue"], a:"Orange", emoji:"ğŸŸ§" },
        { es: "Morado", en: ["Purple","Pink","Brown"], a:"Purple", emoji:"ğŸŸª" },
        { es: "Rosa", en: ["Pink","Purple","Red"], a:"Pink", emoji:"ğŸŒ¸" },
        { es: "Negro", en: ["Black","White","Grey"], a:"Black", emoji:"â¬›" },
        { es: "Blanco", en: ["White","Black","Grey"], a:"White", emoji:"â¬œ" },
        { es: "MarrÃ³n", en: ["Brown","Yellow","Orange"], a:"Brown", emoji:"ğŸŸ«" },
        { es: "Gris", en: ["Grey","Black","White"], a:"Grey", emoji:"ğŸ”˜" },
        { es: "Dorado", en: ["Gold","Silver","Bronze"], a:"Gold", emoji:"ğŸ¥‡" },
        { es: "Plateado", en: ["Silver","Gold","Gray"], a:"Silver", emoji:"ğŸ¥ˆ" },
        { es: "Claro", en: ["Light","Dark","Bright"], a:"Light", emoji:"ğŸ’¡" },
        { es: "Oscuro", en: ["Dark","Light","Deep"], a:"Dark", emoji:"ğŸŒ‘" }
    ],
    food: [
        { es: "Manzana", en: ["Apple","Banana","Grape"], a:"Apple", emoji:"ğŸ" },
        { es: "Banana", en: ["Banana","Pear","Orange"], a:"Banana", emoji:"ğŸŒ" },
        { es: "Uvas", en: ["Grape","Apple","Orange"], a:"Grape", emoji:"ğŸ‡" },
        { es: "Naranja", en: ["Orange","Apple","Banana"], a:"Orange", emoji:"ğŸŠ" },
        { es: "Fresa", en: ["Strawberry","Cherry","Apple"], a:"Strawberry", emoji:"ğŸ“" },
        { es: "Pera", en: ["Pear","Apple","Grape"], a:"Pear", emoji:"ğŸ" },
        { es: "PiÃ±a", en: ["Pineapple","Melon","Kiwi"], a:"Pineapple", emoji:"ğŸ" },
        { es: "Pan", en: ["Bread","Toast","Cake"], a:"Bread", emoji:"ğŸ" },
        { es: "Queso", en: ["Cheese","Butter","Yogurt"], a:"Cheese", emoji:"ğŸ§€" },
        { es: "Pizza", en: ["Pizza","Pasta","Salad"], a:"Pizza", emoji:"ğŸ•" },
        { es: "Huevo", en: ["Egg","Chicken","Milk"], a:"Egg", emoji:"ğŸ¥š" },
        { es: "Leche", en: ["Milk","Water","Juice"], a:"Milk", emoji:"ğŸ¥›" },
        { es: "AzÃºcar", en: ["Sugar","Salt","Flour"], a:"Sugar", emoji:"ğŸ¬" },
        { es: "Carne", en: ["Meat","Fish","Poultry"], a:"Meat", emoji:"ğŸ¥©" },
        { es: "Pescado", en: ["Fish","Meat","Chicken"], a:"Fish", emoji:"ğŸŸ" },
        { es: "Helado", en: ["Ice Cream","Yogurt","Cake"], a:"Ice Cream", emoji:"ğŸ¦" },
        { es: "Zanahoria", en: ["Carrot","Potato","Tomato"], a:"Carrot", emoji:"ğŸ¥•" },
        { es: "Hamburguesa", en: ["Hamburger","Sandwich","Taco"], a:"Hamburger", emoji:"ğŸ”" }
    ],
    objects: [
        { es:"Casa", en:["House","Tree","Car"], a:"House", emoji:"ğŸ " },
        { es:"Agua", en:["Water","Milk","Juice"], a:"Water", emoji:"ğŸ’§" },
        { es:"Coche", en:["Car","Bike","Bus"], a:"Car", emoji:"ğŸš—" },
        { es:"Libro", en:["Book","Notebook","Pen"], a:"Book", emoji:"ğŸ“š" },
        { es:"Llave", en:["Key","Lock","Door"], a:"Key", emoji:"ğŸ”‘" },
        { es:"Mesa", en:["Table","Chair","Desk"], a:"Table", emoji:"ğŸª‘" },
        { es:"Silla", en:["Chair","Sofa","Couch"], a:"Chair", emoji:"ğŸª‘" },
        { es:"TelÃ©fono", en:["Phone","Tablet","Screen"], a:"Phone", emoji:"ğŸ“±" },
        { es:"Reloj", en:["Clock","Watch","Time"], a:"Clock", emoji:"â°" },
        { es:"LÃ¡piz", en:["Pencil","Pen","Eraser"], a:"Pencil", emoji:"âœï¸" },
        { es:"Ventana", en:["Window","Door","Wall"], a:"Window", emoji:"ğŸªŸ" },
        { es:"Computadora", en:["Computer","Screen","Keyboard"], a:"Computer", emoji:"ğŸ’»" },
        { es:"TelevisiÃ³n", en:["Television","Radio","Screen"], a:"Television", emoji:"ğŸ“º" },
        { es:"Cama", en:["Bed","Pillow","Blanket"], a:"Bed", emoji:"ğŸ›ï¸" },
        { es:"Puerta", en:["Door","Wall","Roof"], a:"Door", emoji:"ğŸšª" },
        { es:"Luz", en:["Light","Darkness","Lamp"], a:"Light", emoji:"ğŸ’¡" },
        { es:"Espejo", en:["Mirror","Glass","Picture"], a:"Mirror", emoji:"ğŸª" },
        { es:"Dinero", en:["Money","Coin","Cash"], a:"Money", emoji:"ğŸ’°" },
        { es:"MÃºsica", en:["Music","Song","Sound"], a:"Music", emoji:"ğŸ¶" }
    ],
    clothes: [
        { es:"Camiseta", en:["T-Shirt","Shirt","Jacket"], a:"T-Shirt", emoji:"ğŸ‘•" },
        { es:"Pantalones", en:["Pants","Shorts","Skirt"], a:"Pants", emoji:"ğŸ‘–" },
        { es:"Zapatos", en:["Shoes","Socks","Boots"], a:"Shoes", emoji:"ğŸ‘Ÿ" },
        { es:"Vestido", en:["Dress","Skirt","Suit"], a:"Dress", emoji:"ğŸ‘—" },
        { es:"Chaqueta", en:["Jacket","Coat","Sweater"], a:"Jacket", emoji:"ğŸ§¥" },
        { es:"Calcetines", en:["Socks","Gloves","Hat"], a:"Socks", emoji:"ğŸ§¦" },
        { es:"Sombrero", en: ["Hat","Cap","Scarf"], a:"Hat", emoji:"ğŸ©" },
        { es:"Falda", en:["Skirt","Dress","Pants"], a:"Skirt", emoji:"ğŸ‘—" },
        { es:"Abrigo", en:["Coat","Jacket","Sweater"], a:"Coat", emoji:"ğŸ§¥" },
        { es:"Guantes", en:["Gloves","Socks","Mittens"], a:"Gloves", emoji:"ğŸ§¤" },
        { es:"Bufanda", en:["Scarf","Tie","Belt"], a:"Scarf", emoji:"ğŸ§£" },
        { es:"Traje", en:["Suit","Dress","Jacket"], a:"Suit", emoji:"ğŸ‘”" }
    ],
    vehicles: [
        { es:"Coche", en:["Car","Bike","Bus"], a:"Car", emoji:"ğŸš—" },
        { es:"AviÃ³n", en:["Plane","Helicopter","Car"], a:"Plane", emoji:"âœˆï¸" },
        { es:"Bicicleta", en:["Bike","Motorcycle","Car"], a:"Bike", emoji:"ğŸš²" },
        { es:"AutobÃºs", en:["Bus","Train","Car"], a:"Bus", emoji:"ğŸšŒ" },
        { es:"Tren", en:["Train","Subway","Tram"], a:"Train", emoji:"ğŸš†" },
        { es:"Barco", en:["Boat","Ship","Yacht"], a:"Boat", emoji:"ğŸš¢" },
        { es:"CamiÃ³n", en:["Truck","Van","Bus"], a:"Truck", emoji:"ğŸšš" },
        { es:"Motocicleta", en:["Motorcycle","Bike","Scooter"], a:"Motorcycle", emoji:"ğŸï¸" },
        { es:"Ambulancia", en:["Ambulance","Police","Fire"], a:"Ambulance", emoji:"ğŸš‘" },
        { es:"Taxi", en:["Taxi","Bus","Car"], a:"Taxi", emoji:"ğŸš•" }
    ],
    emotions: [
        { es:"Feliz", en:["Happy","Sad","Angry"], a:"Happy", emoji:"ğŸ˜Š" },
        { es:"Triste", en:["Sad","Happy","Angry"], a:"Sad", emoji:"ğŸ˜¢" },
        { es:"Enfadado", en:["Angry","Bored","Scared"], a:"Angry", emoji:"ğŸ˜¡" },
        { es:"Sorprendido", en:["Surprised","Confused","Shy"], a:"Surprised", emoji:"ğŸ˜®" },
        { es:"Cansado", en:["Tired","Sleepy","Relaxed"], a:"Tired", emoji:"ğŸ˜´" },
        { es:"Aburrido", en:["Bored","Calm","Excited"], a:"Bored", emoji:"ğŸ˜’" },
        { es:"Asustado", en:["Scared","Brave","Safe"], a:"Scared", emoji:"ğŸ˜¨" },
        { es:"Emocionado", en:["Excited","Calm","Bored"], a:"Excited", emoji:"ğŸ¤©" },
        { es:"Confundido", en:["Confused","Clear","Sure"], a:"Confused", emoji:"ğŸ˜•" },
        { es:"Alegre", en:["Joyful","Gloomy","Tired"], a:"Joyful", emoji:"ğŸ˜„" },
        { es:"Calmado", en:["Calm","Nervous","Excited"], a:"Calm", emoji:"ğŸ˜Œ" }
    ],
    sports: [
        { es:"FÃºtbol", en:["Soccer","Basketball","Tennis"], a:"Soccer", emoji:"âš½" },
        { es:"Baloncesto", en:["Basketball","Soccer","Tennis"], a:"Basketball", emoji:"ğŸ€" },
        { es:"Tenis", en:["Tennis","Volleyball","Baseball"], a:"Tennis", emoji:"ğŸ¾" },
        { es:"NataciÃ³n", en:["Swimming","Running","Cycling"], a:"Swimming", emoji:"ğŸŠ" },
        { es:"BÃ©isbol", en:["Baseball","Soccer","Golf"], a:"Baseball", emoji:"âš¾" },
        { es:"Correr", en:["Running","Walking","Jumping"], a:"Running", emoji:"ğŸƒ" },
        { es:"Voleibol", en:["Volleyball","Handball","Rugby"], a:"Volleyball", emoji:"ğŸ" },
        { es:"Ciclismo", en:["Cycling","Running","Walking"], a:"Cycling", emoji:"ğŸš´" },
        { es:"Boxeo", en:["Boxing","Karate","Judo"], a:"Boxing", emoji:"ğŸ¥Š" },
        { es:"Golf", en:["Golf","Tennis","Polo"], a:"Golf", emoji:"â›³" },
        { es:"Patinaje", en:["Skating","Skiing","Surfing"], a:"Skating", emoji:"â›¸ï¸" }
    ],
    actions: [
        { es:"Correr", en:["Run","Walk","Jump"], a:"Run", emoji:"ğŸƒ" },
        { es:"Comer", en:["Eat","Drink","Sleep"], a:"Eat", emoji:"ğŸ½ï¸" },
        { es:"Beber", en:["Drink","Eat","Sleep"], a:"Drink", emoji:"ğŸ¥¤" },
        { es:"Dormir", en:["Sleep","Wake","Rest"], a:"Sleep", emoji:"ğŸ˜´" },
        { es:"Hablar", en:["Speak","Listen","Say"], a:"Speak", emoji:"ğŸ—£ï¸" },
        { es:"Escribir", en:["Write","Read","Draw"], a:"Write", emoji:"âœï¸" },
        { es:"Leer", en:["Read","Write","Look"], a:"Read", emoji:"ğŸ“–" },
        { es:"Jugar", en:["Play","Work","Study"], a:"Play", emoji:"ğŸ®" },
        { es:"Ver", en:["See","Look","Watch"], a:"See", emoji:"ğŸ‘€" },
        { es:"Escuchar", en:["Listen","Hear","Speak"], a:"Listen", emoji:"ğŸ‘‚" },
        { es:"Caminar", en:["Walk","Run","Jump"], a:"Walk", emoji:"ğŸš¶â€â™€ï¸" },
        { es:"Saltar", en:["Jump","Run","Fly"], a:"Jump", emoji:"ğŸ¤¸" },
        { es:"Nadar", en:["Swim","Dive","Float"], a:"Swim", emoji:"ğŸŠ" },
        { es:"Cocinar", en:["Cook","Bake","Eat"], a:"Cook", emoji:"ğŸ³" },
        { es:"Bailar", en:["Dance","Sing","Move"], a:"Dance", emoji:"ğŸ’ƒ" }
    ]
};


// ====================================================================
// ğŸ® LÃ“GICA DEL JUEGO (GAME LOGIC)
// ====================================================================

let selectedCategory = null;
let selectedDifficulty = null;
let score = 0;
// highscore se carga desde el almacenamiento local
let highScore = localStorage.getItem("highScore") || 0; 
let lives = 5;
let timer = 60;
let timerInterval;

// FunciÃ³n para mostrar una celebraciÃ³n temporal (fondo verde)
function celebrate() {
    document.body.style.backgroundColor = '#ccffcc'; 
    setTimeout(() => {
        document.body.style.backgroundColor = '#ffffff'; 
    }, 400); // 400ms de celebraciÃ³n
}

// FunciÃ³n para mostrar un error temporal (fondo rojo)
function showMistake() {
    document.body.style.backgroundColor = '#ffcccc'; 
    setTimeout(() => {
        document.body.style.backgroundColor = '#ffffff'; 
    }, 400); // 400ms de error
}

function selectCategory(cat){ selectedCategory = cat; }
function selectDifficulty(diff){ selectedDifficulty = diff; }

function startGame(){
    if(!selectedCategory || !selectedDifficulty){
        alert("Debes seleccionar categorÃ­a y dificultad para iniciar");
        return;
    }
    document.getElementById("menu").style.display = "none";
    document.getElementById("game").style.display = "block";
    score = 0;
    lives = 5;

    if (selectedDifficulty === 'easy') {
        lives = 5
    } else if (selectedDifficulty === 'medium') {
        lives = 3
    } else {
        lives = 2
    }
    // Asigna tiempo basado en la dificultad
    timer = selectedDifficulty === "easy" ? 60 : selectedDifficulty === "medium" ? 45 : 30; 

    document.getElementById("score").innerText = "Puntos: " + score;
    document.getElementById("lives").innerText = "Vidas: " + "â¤ï¸".repeat(lives);
    // Asegura que el highscore mostrado sea un nÃºmero
    document.getElementById("highscore").innerText = "Puntaje mÃ¡s alto: " + highScore; 
    document.getElementById("timer").innerText = "Tiempo: " + timer;
    
    clearInterval(timerInterval); // Limpia cualquier intervalo previo
    timerInterval = setInterval(()=>{
        timer--;
        document.getElementById("timer").innerText = "Tiempo: " + timer;
     if(timer <= 0) endGame('time_out'); // <--- AÃ‘ADIDO: 'time_out'
    }, 1000);
    nextWord();
}

function nextWord(){
    if(lives <= 0){ endGame('lives_out'); return; }
    
    const wordsArray = WORDS[selectedCategory];
    const word = wordsArray[Math.floor(Math.random()*wordsArray.length)];
    document.getElementById("question").innerText = `${word.emoji} Â¿CÃ³mo se dice "${word.es}" en inglÃ©s?`;
    
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";
    
    const shuffledOptions = word.en.sort(()=>Math.random()-0.5);
    
    shuffledOptions.forEach(opt=>{
        const btn = document.createElement("button");
        btn.className = "word-btn";
        btn.innerText = opt;
        
        // Captura todos los botones antes de asignar el click
        const optionsButtons = Array.from(optionsDiv.children);

        btn.onclick = (event)=>{
            // Desactivar todos los botones para prevenir mÃºltiples clics
            optionsButtons.forEach(b => b.disabled = true); 

            if(opt === word.a){
                score += 10;
                btn.classList.add("correct");
                celebrate(); 
            } else {
                lives--;
                btn.classList.add("incorrect");
                showMistake();
                // Resaltar la respuesta correcta
                optionsButtons.find(b => b.innerText === word.a).classList.add("correct");
            }
            
            document.getElementById("score").innerText = "Puntos: " + score;
            document.getElementById("lives").innerText = "Vidas: " + "â¤ï¸".repeat(lives);
            
            // Actualizar HighScore
            if(score > highScore){ 
                highScore = score; 
                localStorage.setItem("highScore", highScore); 
            }
            document.getElementById("highscore").innerText = "Puntaje mÃ¡s alto: " + highScore;
            
            // Espera 1 segundo (para ver el feedback) antes de la siguiente palabra
            setTimeout(nextWord, 1000); 
        };
        optionsDiv.appendChild(btn);
        
        // Re-captura los botones despuÃ©s de aÃ±adirlos (necesario si optionsButtons se usa dentro del click)
        if (optionsButtons.length === 0) {
            // Esto es solo para asegurar que la referencia a optionsButtons en el click es correcta
            optionsButtons.push(btn); 
        }
    });
}

function endGame(reason){ // <-- RECIBE EL ARGUMENTO 'reason'
    clearInterval(timerInterval);
    document.getElementById("game").style.display = "none";
    document.getElementById("scoreboard").style.display = "block";
    
    // --- NUEVA LÃ“GICA DE MENSAJE DE PÃ‰RDIDA ---
    const endTitle = document.getElementById("scoreboard").querySelector("h2");
    
    if (reason === 'lives_out') {
        endTitle.innerHTML = "Â¡Juego terminado! ğŸ˜­ Se te acabaron las vidas.";
    } else if (reason === 'time_out') {
        endTitle.innerHTML = "Â¡Juego terminado! â±ï¸ Se te acabÃ³ el tiempo.";
    } else {
        endTitle.innerHTML = "Â¡Juego terminado! ğŸ†";
    }
    // ------------------------------------------

    document.getElementById("final-score").innerText = `Tu puntaje final es: ${score}`;
    
    const storedHighScore = localStorage.getItem("highScore") || 0;
    document.getElementById("final-highscore").innerText = `Puntaje mÃ¡s alto: ${storedHighScore}`;
    
    const finalMessageElement = document.getElementById("final-message");

    // LÃ³gica de felicitaciÃ³n/Ã¡nimo (la que ya tenÃ­as)
    if (score > storedHighScore) {
        finalMessageElement.innerHTML = `ğŸ‰ **Â¡FENOMENAL! Â¡Has establecido un NUEVO RÃ‰CORD de ${score} puntos!** ğŸ¥³`;
    } else if (score == storedHighScore && score > 0) {
        finalMessageElement.innerHTML = `ğŸŒŸ **Â¡IncreÃ­ble desempeÃ±o! Â¡Igualaste tu mejor marca!** ğŸ‘`;
    } else if (score > 0) {
        finalMessageElement.innerHTML = `âœ¨ **Â¡Excelente esfuerzo! Sigue asÃ­. Â¡Con un poco mÃ¡s de prÃ¡ctica, superarÃ¡s ese rÃ©cord!** ğŸ’ª`;
    } else {
        finalMessageElement.innerHTML = `ğŸ˜” **Sigue practicando. Cada error es una lecciÃ³n. Â¡Vuelve a intentarlo!** ğŸ‘`;
    }
}

function restartGame(){
    document.getElementById("scoreboard").style.display = "none";
    document.getElementById("menu").style.display = "block";
    selectedCategory = null;
    selectedDifficulty = null;
}

// Mostrar menÃº al cargar
document.getElementById("menu").style.display = "block";
</script>

</body>
</html>